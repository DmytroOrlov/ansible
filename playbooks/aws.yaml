# ansible-playbook --ask-vault-pass --key-file=~/.ssh/ire/id_rsa --extra-vars="secret=STAGE" aws.yaml
---
- hosts: localhost
  connection: local
  gather_facts: False
  vars:
    ec2_count: 1
    wait: yes
    aws_access_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66323632323866663330323961303635363064306461643865326434346536633832313639393736
          3236356238613265363466633063323762316533643862360a363764666263663030653566343633
          38643938646635393561353539356535313633643238656463636163656530633638323836313338
          6163376639356263340a663962643564646166613239623739643433386463306139393664343630
          34666464626136626632643861353230373734376130356637336539313836613030
    aws_secret_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          62623463376633333330396534623866343131383965363537323861313635323537393130626563
          6138633833393237333164353735613265346531373264310a653438646263326339643930383935
          35346133343137316430313636613763323931623236663037313238306135653231306333333137
          3863363238363236390a623833643563643230663961653735653333356334626335373734363761
          63363264633735303732653761643331306165336636333036333961383561363161313362376137
          3764386366626430656161646330316431656431653862653234
  roles:
    - role: keypair
    - role: security-group
    - role: ire-web
      vars:
        zone: a
    - role: ire-web-dns
      vars:
        zone: a
    - role: ire-web
      vars:
        zone: b
    - role: ire-web-dns
      vars:
        zone: b
    - role: elb-web
    - role: elb-web-dns

- hosts: ec2hosts
  user: ubuntu
  gather_facts: False
  roles:
    - role: python-minimal
- hosts: ec2hosts
  user: ubuntu
  name: Configure ire.web
  roles:
    - role: jdk
    - role: ntpd
    - role: web-app
